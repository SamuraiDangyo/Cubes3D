<!-- (C) 2020 Toni Helminen <GPLv3> --><!doctype html><html><head><meta charset="utf-8"><title>Cubes3D 4.8kB</title></head><body><canvas onclick="mc()" style="background:#111" id="myc" width=700 height=700></canvas><script>let mc=0;!function(){const t={gr:.01,fr:20},s={isf:function(t){return Number(t)===t&&t%1!=0},grc:function(){let t="#";for(let i=0;i<6;i++)t+="0123456789ABCDEF"[s.rnd(0,16)];return t},rnd:function(t,i,r){if(null==r)return s.rnd(t,i,!1);if(null==t)return s.rnd(0,1,!0);if(null==i)return s.rnd(0,t,!1);if(t>i)return s.rnd(i,t,r);(s.isf(t)||s.isf(i))&&(r=!0);const o=Math.random()*(i-t);return t+(r?o:parseInt(o,10))}};"sin|cos|sqrt".split("|").forEach(t=>s[t]=Math[t]),s.v4D=function(t,s){return[t[0]-s[0],t[1]-s[1],t[2]-s[2],1]},s.mM4D=function(t,s){const i=t,r=s;return[i[0]*r[0]+i[1]*r[4]+i[2]*r[8]+i[3]*r[12],i[0]*r[1]+i[1]*r[5]+i[2]*r[9]+i[3]*r[13],i[0]*r[2]+i[1]*r[6]+i[2]*r[10]+i[3]*r[14],i[0]*r[3]+i[1]*r[7]+i[2]*r[11]+i[3]*r[15],i[4]*r[0]+i[5]*r[4]+i[6]*r[8]+i[7]*r[12],i[4]*r[1]+i[5]*r[5]+i[6]*r[9]+i[7]*r[13],i[4]*r[2]+i[5]*r[6]+i[6]*r[10]+i[7]*r[14],i[4]*r[3]+i[5]*r[7]+i[6]*r[11]+i[7]*r[15],i[8]*r[0]+i[9]*r[4]+i[10]*r[8]+i[11]*r[12],i[8]*r[1]+i[9]*r[5]+i[10]*r[9]+i[11]*r[13],i[8]*r[2]+i[9]*r[6]+i[10]*r[10]+i[11]*r[14],i[8]*r[3]+i[9]*r[7]+i[10]*r[11]+i[11]*r[15],i[12]*r[0]+i[13]*r[4]+i[14]*r[8]+i[15]*r[12],i[12]*r[1]+i[13]*r[5]+i[14]*r[9]+i[15]*r[13],i[12]*r[2]+i[13]*r[6]+i[14]*r[10]+i[15]*r[14],i[12]*r[3]+i[13]*r[7]+i[14]*r[11]+i[15]*r[15]]},s.roMX4D=function(t=0){const i=s.sin(t),r=s.cos(t);return[1,0,0,0,0,r,-i,0,0,i,r,0,0,0,0,1]},s.roMY4D=function(t=0){const i=s.sin(t),r=s.cos(t);return[r,0,i,0,0,1,0,0,-i,0,r,0,0,0,0,1]},s.roMZ4D=function(t=0){const i=s.sin(t),r=s.cos(t);return[r,-i,0,0,i,r,0,0,0,0,1,0,0,0,0,1]},s.trM4D=function(t=0,s=0,i=0){return[1,0,0,t,0,1,0,s,0,0,1,i,0,0,0,1]},s.sM4D=function(t=1,s=1,i=1){return[t,0,0,0,0,s,0,0,0,0,i,0,0,0,0,1]},s.p3D=function(s){const i=t.c.width,r=t.c.height;return s[2]?[i/2+i/2*s[0]/s[2],r/2+r/2*s[1]/s[2]]:[0,0]},s.vXM4D=function(t,s){const i=s,r=t;return[i[0]*r[0]+i[1]*r[1]+i[2]*r[2]+i[3]*r[3],i[4]*r[0]+i[5]*r[1]+i[6]*r[2]+i[7]*r[3],i[8]*r[0]+i[9]*r[1]+i[10]*r[2]+i[11]*r[3],1]};class i{constructor(t,i){t.length<4&&t.push(1),i.length<4&&i.push(1),this.f=t.slice(),this.to=i.slice(),this.d=s.v4D(t,i)}clone(){return new i(this.f,this.to)}roX(t=0){return this.f=s.vXM4D(this.f,s.roMX4D(t)),this.to=s.vXM4D(this.to,s.roMX4D(t)),this}roY(t=0){return this.f=s.vXM4D(this.f,s.roMY4D(t)),this.to=s.vXM4D(this.to,s.roMY4D(t)),this}roZ(t=0){return this.f=s.vXM4D(this.f,s.roMZ4D(t)),this.to=s.vXM4D(this.to,s.roMZ4D(t)),this}ro(t=0,s=0,i=0){return this.roX(t).roY(s).roZ(i)}s(t=1,i=1,r=1){return this.f=s.vXM4D(this.f,s.sM4D(t,i,r)),this.to=s.vXM4D(this.to,s.sM4D(t,i,r)),this}t(t=0,i=0,r=0){return this.f=s.vXM4D(this.f,s.trM4D(t,i,r)),this.to=s.vXM4D(this.to,s.trM4D(t,i,r)),this}gp(t){const i=s.b(0,t,1);return[this.f[0]+i*this.d[0],this.f[1]+i*this.d[1],this.f[2]+i*this.d[2]]}}class r{constructor(){this.color=s.grc(),this.p=[s.rnd(-2,2),s.rnd(-11,1),s.rnd(20,35)],this.sp=[s.rnd(-.2,.2),s.rnd(-.2,.2),s.rnd(-.2,.2)],this.s=s.rnd(1,3),this.an=[s.rnd(-.05,.05),s.rnd(-.05,.05),s.rnd(-.05,.05)],this.mr()}mr(){const t=[[[-1,-1,-1],[1,-1,-1]],[[-1,-1,-1],[-1,1,-1]],[[-1,1,-1],[1,1,-1]],[[1,-1,-1],[1,1,-1]],[[-1,-1,-1],[-1,-1,1]],[[-1,1,-1],[-1,1,1]],[[1,-1,-1],[1,-1,1]],[[1,1,-1],[1,1,1]],[[-1,-1,1],[1,-1,1]],[[-1,-1,1],[-1,1,1]],[[-1,1,1],[1,1,1]],[[1,-1,1],[1,1,1]]];this.ra=[];for(const s of t)this.ra.push(new i(s[0],s[1]))}tb(){const s=this.p.slice();this.sp[1]+=t.gr,this.p[0]+=this.sp[0],(this.p[0]<-15||this.p[0]>15)&&(this.sp[0]*=-1,this.p[0]=s[0]),this.p[1]+=this.sp[1],this.p[1]>15&&(this.sp[1]*=-1,this.p[1]=s[1]),this.z+=this.sp[2],(this.p[2]<12||this.p[2]>55)&&(this.sp[2]*=-1,this.p[2]=s[2])}tr(){for(const t of this.ra)t.ro(this.an[0],this.an[1],this.an[2])}reR(i){const r=s.p3D(i.f),o=s.p3D(i.to),n=t.context;n.strokeStyle=this.color,n.lineWidth=2,n.beginPath(),n.moveTo(r[0],r[1]),n.lineTo(o[0],o[1]),n.stroke()}ti(){this.tb(),this.tr()}re(){for(const t of this.ra)this.reR(t.clone().s(this.s,this.s,this.s).t(this.p[0],this.p[1],this.p[2]))}}class o{constructor(){this.init(),t.gs=this}init(){this.cc=[];const t=s.rnd(1,10);for(let s=0;s<t;s++)this.cc.push(new r)}ti(){for(const t of this.cc)t.ti()}re(){for(const t of this.cc)t.re()}}class n{constructor(){this.c=window.document.getElementById("myc"),this.context=this.c.getContext("2d"),t.context=this.context,t.c=this.c,this.scs=[new o]}go(){this.interval||(this.re(),this.interval=setInterval(()=>this.upd(),t.fr))}clean(){this.c.getContext("2d").clearRect(0,0,this.c.width,this.c.height)}upd(){this.ti(),this.re()}ti(){for(const t of this.scs)t.ti()}re(){this.clean();for(const t of this.scs)t.re()}}!function(){const s=new n;mc=function(){t.gs.init()},s.go()}()}();</script></body></html>
